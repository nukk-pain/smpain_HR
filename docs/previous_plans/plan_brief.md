# HR 관리 시스템 배포 전환 계획

## 개요
현재 단일 서버 방식에서 클라우드 네이티브 아키텍처로 전환하여 관리 부담을 줄이고 개발에 집중할 수 있는 환경을 구축합니다.

## 목표 아키텍처
- **백엔드**: Google Cloud Run (서버리스 컨테이너)
- **프론트엔드**: Vercel (React 전문 호스팅)
- **데이터베이스**: MongoDB Atlas (관리형 MongoDB)

## 주요 이점
1. **비용 효율성**: 사용량 기반 과금으로 초기 비용 최소화
2. **자동 확장**: 트래픽에 따른 자동 스케일링
3. **관리 간소화**: 인프라 관리 불필요
4. **CI/CD 자동화**: GitHub 연동으로 push 시 자동 배포

## 전환 단계

### 1단계: 데이터베이스 마이그레이션 (MongoDB Atlas)
- MongoDB Atlas 무료 클러스터(M0) 생성
- 기존 데이터 백업 및 이전
- 연결 문자열 업데이트
- 보안 설정 (IP 화이트리스트, 사용자 인증)

### 2단계: 백엔드 컨테이너화 (Google Cloud Run)
- Dockerfile 최적화
- 환경변수 Cloud Run 설정으로 이전
- ecosystem.config.js 제거 (PM2 불필요)
- Health check 엔드포인트 추가
- Cloud Build 설정으로 자동 배포 구성

### 3단계: 프론트엔드 배포 (Vercel)
- GitHub 저장소 연결
- 환경변수 설정 (API_URL 등)
- 빌드 설정 최적화
- 커스텀 도메인 연결

### 4단계: CI/CD 파이프라인 구성
- GitHub Actions 워크플로우 작성
- 자동 테스트 및 배포 설정
- 환경별 배포 전략 수립

## 주요 변경사항

### 코드 변경
1. **환경변수 관리**
   - .env 파일에서 클라우드 서비스 환경변수로 전환
   - 각 서비스별 환경변수 설정 방식 적용

2. **세션 관리**
   - MongoDB 세션 저장소 유지 (Atlas 호환)
   - Redis 대안 검토 (필요시)

3. **파일 업로드**
   - Cloud Storage 연동 검토
   - 임시 파일 처리 방식 개선

### 설정 파일 변경
- `Dockerfile`: 멀티스테이지 빌드로 최적화
- `package.json`: 배포 스크립트 업데이트
- 새로운 설정 파일 추가 (vercel.json, cloudbuild.yaml)

## 예상 일정
- 1주차: MongoDB Atlas 마이그레이션
- 2주차: 백엔드 Cloud Run 배포
- 3주차: 프론트엔드 Vercel 배포
- 4주차: CI/CD 파이프라인 완성 및 테스트

## 리스크 및 대응방안
1. **데이터 마이그레이션 중 서비스 중단**
   - 점진적 마이그레이션 전략 수립
   - 백업 및 롤백 계획 준비

2. **환경변수 및 시크릿 관리**
   - 각 서비스의 시크릿 관리 기능 활용
   - 환경별 설정 분리

3. **네트워크 레이턴시**
   - 같은 리전에 서비스 배포
   - CDN 활용 (Vercel 기본 제공)

## 다음 단계
1. 각 클라우드 서비스 계정 생성
2. 테스트 환경 구축
3. 단계별 마이그레이션 시작