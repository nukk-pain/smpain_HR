# 🧪 휴가 관리 시스템 테스트 가이드

## 🎯 테스트 목표

1. **백엔드 API 동작 확인**
2. **프론트엔드 UI 동작 확인**
3. **통합 기능 테스트**
4. **권한 시스템 테스트**
5. **데이터 검증 테스트**

## 🚀 1단계: 서버 실행

### 백엔드 서버 실행
```bash
cd backend
node server.js
```
- 포트: 5444
- 확인: `http://localhost:5444/api/users` (로그인 필요)

### 프론트엔드 서버 실행
```bash
cd frontend
npm run dev
```
- 포트: 3000
- 확인: `http://localhost:3000`

## 🔐 2단계: 초기 로그인

### 기본 관리자 계정
- **사용자명**: `admin`
- **비밀번호**: `admin`

### 테스트 계정 생성 (필요시)
관리자로 로그인 후 사용자 관리에서 생성:
1. **매니저 계정**: manager / manager123
2. **일반 사용자**: user1 / user123

## 🧪 3단계: 기능별 테스트

### A. 휴가 잔여일수 API 테스트

#### 1. 브라우저 개발자 도구 열기 (F12)
#### 2. 콘솔에서 다음 명령어 실행:

```javascript
// 내 휴가 잔여일수 확인
fetch('/api/leave/balance')
  .then(res => res.json())
  .then(data => console.log('내 잔여일수:', data));

// 특정 사용자 잔여일수 확인 (관리자/매니저만)
fetch('/api/leave/balance/USER_ID')
  .then(res => res.json())
  .then(data => console.log('사용자 잔여일수:', data));
```

### B. 휴가 신청 API 테스트

```javascript
// 휴가 신청 생성
fetch('/api/leave', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    leaveType: 'annual',
    startDate: '2024-07-15',
    endDate: '2024-07-16',
    reason: '개인 용무',
    substituteEmployee: '대체 직원명'
  })
})
.then(res => res.json())
.then(data => console.log('신청 결과:', data));
```

### C. 휴가 목록 조회 테스트

```javascript
// 내 휴가 목록 조회
fetch('/api/leave')
  .then(res => res.json())
  .then(data => console.log('내 휴가 목록:', data));

// 승인 대기 목록 조회 (관리자/매니저만)
fetch('/api/leave/pending')
  .then(res => res.json())
  .then(data => console.log('승인 대기 목록:', data));
```

### D. 휴가 승인/거부 테스트

```javascript
// 휴가 승인 (관리자/매니저만)
fetch('/api/leave/REQUEST_ID/approve', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    action: 'approve',
    comment: '승인합니다'
  })
})
.then(res => res.json())
.then(data => console.log('승인 결과:', data));

// 휴가 거부
fetch('/api/leave/REQUEST_ID/approve', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    action: 'reject',
    comment: '일정 조정이 필요합니다'
  })
})
.then(res => res.json())
.then(data => console.log('거부 결과:', data));
```

## 🖥️ 4단계: UI 테스트

### A. 휴가 신청 폼 테스트

1. **휴가 관리 페이지 접속**
   - 메뉴에서 "휴가 관리" 클릭
   - 또는 직접 `http://localhost:3000/leave` 접속

2. **휴가 신청 버튼 클릭**
   - 우측 상단의 "휴가 신청" 버튼 클릭

3. **폼 작성 및 검증**
   - 휴가 종류 선택: 연차, 병가, 개인휴가, 경조사
   - 시작일/종료일 선택 (DatePicker 동작 확인)
   - 신청 사유 입력
   - 대체 인력 입력 (선택사항)
   - 실시간 일수 계산 확인
   - 잔여 연차 표시 확인

4. **유효성 검증 테스트**
   - 과거 날짜 선택 시 에러 메시지
   - 종료일 < 시작일 시 에러 메시지
   - 사유 미입력 시 에러 메시지
   - 잔여 연차 부족 시 에러 메시지

### B. 휴가 현황 대시보드 테스트

1. **잔여일수 카드 확인**
   - 총 연차일수 표시
   - 사용된 연차일수 표시
   - 잔여 연차일수 표시
   - 진행률 바 표시

2. **휴가 신청 내역 테이블**
   - 신청 목록 표시
   - 상태별 색상 표시 (대기중/승인됨/거부됨)
   - 수정/삭제 버튼 (대기중인 경우만)

### C. 관리자 승인 인터페이스 테스트

1. **매니저/관리자 계정으로 로그인**

2. **승인 관리 탭 확인**
   - 승인 대기 목록 표시
   - 신청자 정보 표시
   - 승인/거부 버튼 동작

3. **승인 처리 테스트**
   - 승인 버튼 클릭 → 성공 메시지 확인
   - 거부 버튼 클릭 → 사유 입력 다이얼로그 → 거부 처리

## 🔍 5단계: 권한 시스템 테스트

### A. 사용자 권한 테스트

1. **일반 사용자 로그인**
   - 본인 휴가만 조회 가능
   - 휴가 신청 가능
   - 승인 관리 탭 비표시

2. **매니저 권한 테스트**
   - 같은 부서 직원 휴가 승인 가능
   - 다른 부서 직원 휴가 접근 불가
   - 부서 내 승인 대기 목록만 표시

3. **관리자 권한 테스트**
   - 모든 휴가 신청 조회 가능
   - 모든 휴가 승인/거부 가능
   - 전체 승인 대기 목록 표시

### B. API 권한 테스트

브라우저 콘솔에서 권한 테스트:

```javascript
// 일반 사용자가 다른 사용자 잔여일수 조회 시도 (403 에러 예상)
fetch('/api/leave/balance/OTHER_USER_ID')
  .then(res => {
    if (res.status === 403) {
      console.log('✅ 권한 제한 정상 동작');
    } else {
      console.log('❌ 권한 제한 실패');
    }
  });

// 일반 사용자가 승인 대기 목록 조회 시도 (403 에러 예상)
fetch('/api/leave/pending')
  .then(res => {
    if (res.status === 403) {
      console.log('✅ 권한 제한 정상 동작');
    } else {
      console.log('❌ 권한 제한 실패');
    }
  });
```

## 🎯 6단계: 비즈니스 로직 테스트

### A. 연차 계산 로직 테스트

1. **사용자 입사일 확인**
   - 사용자 관리에서 입사일 확인
   - 근속년수에 따른 연차 계산 확인

2. **연차 계산 공식 검증**
   - 1년차: 11일
   - 2년차 이상: 15일 + (근속년수 - 1)
   - 최대: 25일

### B. 휴가 일수 계산 테스트

1. **주말 제외 계산**
   - 월요일~금요일 선택 시 정확한 일수 계산
   - 주말 포함 선택 시 주말 제외 계산

2. **연속 휴가 계산**
   - 여러 날 연속 선택 시 정확한 계산

### C. 중복 신청 방지 테스트

1. **동일 기간 중복 신청**
   - 같은 기간 재신청 시 에러 메시지

2. **겹치는 기간 신청**
   - 일부 겹치는 기간 신청 시 에러 메시지

## 🐛 7단계: 에러 시나리오 테스트

### A. 네트워크 에러 테스트

1. **서버 중단 후 테스트**
   - 백엔드 서버 중단
   - 프론트엔드에서 API 호출 시 에러 처리 확인

2. **잘못된 데이터 전송**
   - 개발자 도구에서 잘못된 API 호출
   - 에러 메시지 표시 확인

### B. 유효성 검증 테스트

1. **필수 필드 누락**
   - 사유 미입력 시 에러 메시지
   - 날짜 미선택 시 에러 메시지

2. **잘못된 날짜 입력**
   - 과거 날짜 선택 시 에러 메시지
   - 종료일 < 시작일 시 에러 메시지

## 📊 8단계: 성능 테스트

### A. 대용량 데이터 테스트

1. **다량의 휴가 신청 생성**
   - 여러 사용자로 다량 신청 생성
   - 목록 조회 성능 확인

2. **페이지네이션 테스트**
   - 많은 데이터 상황에서 페이지네이션 동작 확인

### B. 동시 접근 테스트

1. **여러 브라우저 탭에서 동시 접근**
   - 세션 관리 확인
   - 데이터 일관성 확인

## ✅ 9단계: 테스트 체크리스트

### 필수 기능 체크리스트

- [ ] 로그인/로그아웃 동작
- [ ] 휴가 신청 생성
- [ ] 휴가 신청 수정
- [ ] 휴가 신청 삭제
- [ ] 휴가 승인/거부
- [ ] 휴가 목록 조회
- [ ] 휴가 잔여일수 조회
- [ ] 승인 대기 목록 조회
- [ ] 권한별 접근 제어
- [ ] 에러 처리 및 사용자 알림

### UI/UX 체크리스트

- [ ] 반응형 디자인 (모바일/데스크톱)
- [ ] 로딩 상태 표시
- [ ] 에러 메시지 표시
- [ ] 성공 메시지 표시
- [ ] 실시간 데이터 업데이트
- [ ] 폼 유효성 검증
- [ ] 날짜 선택기 한국어 지원
- [ ] 아이콘 및 색상 일관성

### 보안 체크리스트

- [ ] 세션 기반 인증
- [ ] 역할별 권한 제어
- [ ] API 권한 검증
- [ ] 입력값 검증
- [ ] XSS 방지
- [ ] CSRF 방지

## 🚨 문제 발생 시 해결책

### 1. JWT 서버 연결 오류
```bash
# 포트 확인 (JWT 포트 변경됨)
netstat -ano | findstr :8080
netstat -ano | findstr :3727

# 서버 재시작
cd backend && node server.js
cd frontend && npm run dev

# JWT 헬스 체크
curl http://localhost:8080/health
# 응답에 "authentication": "JWT" 포함되어야 함
```

### 2. 데이터베이스 연결 오류
```bash
# MongoDB 서비스 상태 확인
net start MongoDB

# 데이터베이스 연결 테스트
cd backend && node check-db.js
```

### 3. 프론트엔드 빌드 오류
```bash
# 의존성 재설치
cd frontend
rm -rf node_modules
npm install

# 타입 에러 확인
npm run build
```

### 4. API 호출 오류
- 브라우저 개발자 도구 > Network 탭에서 API 호출 확인
- 403 에러: 권한 문제, 로그인 상태 확인
- 500 에러: 서버 로그 확인
- 404 에러: API 엔드포인트 확인

## 📝 테스트 결과 기록

각 테스트 항목을 체크하면서 문제점을 기록하세요:

```
✅ 휴가 신청 생성 - 정상 동작
❌ 휴가 승인 처리 - 에러 메시지: [구체적인 에러 내용]
✅ 권한 제어 - 정상 동작
⚠️ UI 반응성 - 모바일에서 일부 버튼 크기 문제
```

이 가이드를 따라 단계별로 테스트를 진행하면 휴가 관리 시스템의 모든 기능을 검증할 수 있습니다! 🚀