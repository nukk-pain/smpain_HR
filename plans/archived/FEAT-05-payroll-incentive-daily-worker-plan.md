# FEAT-05: 급여 관리 개선 - 인센티브 자동 계산 및 일용직 관리

## 📋 개요
- **생성일**: 2025년 08월 26일
- **우선순위**: HIGH
- **예상 소요 시간**: 5시간
- **관련 요청**: 
  - 매출 입력 시 인센티브 자동 계산 및 표시
  - 인센티브 복사 기능 (노무사 전달용)
  - 일용직 급여 관리 기능

## 🎯 목표
1. 매출 입력과 인센티브 계산을 통합하여 같은 화면에서 처리
2. 인센티브 계산 결과를 천원 단위로 올림 처리
3. 노무사에게 전달할 인센티브 정보를 쉽게 복사할 수 있는 기능
4. 일용직 급여를 별도로 관리하고 복사할 수 있는 기능
5. 총 급여 계산에 일용직 급여 포함

## 📝 구현 계획

### Phase 1: 매출-인센티브 통합 (2시간)

#### 1.1 백엔드 수정
- [ ] `/api/sales/bulk` 엔드포인트 수정
  - 매출 저장 후 자동 인센티브 계산
  - 계산 결과를 응답에 포함
  - 실패한 계산에 대한 에러 처리

#### 1.2 IncentiveService 수정
- [ ] `getSalesData` 메서드 필드 매핑 수정
  - `individualSales` → `personal`
  - `companySales.totalAmount` → `total`
- [ ] 병렬 처리로 성능 개선 (Promise.all)
- [ ] 인센티브 계산 결과를 천원 단위로 올림 처리
  - `Math.ceil(amount / 1000) * 1000`

#### 1.3 프론트엔드 SalesManagement 컴포넌트 개선
- [ ] 인센티브 계산 결과 표시 섹션 추가
- [ ] 매출 저장 시 자동으로 인센티브 표시
- [ ] 계산 실패 시 에러 메시지 표시

### Phase 2: 인센티브 복사 기능 (1시간)

#### 2.1 복사 기능 구현
- [ ] 인센티브 결과 테이블 하단에 "복사하기" 버튼 추가
- [ ] 복사 형식: "2025년 8월 인센티브\n김철수: 500,000원\n이영희: 300,000원"
- [ ] 클립보드 API 활용
- [ ] 복사 성공 시 토스트 알림

#### 2.2 UI/UX 개선
- [ ] 인센티브 결과를 카드 형태로 표시
- [ ] 총 인센티브 금액 표시
- [ ] 각 직원별 계산 방식 표시 (PERSONAL_PERCENT 등)

### Phase 3: 일용직 급여 관리 (2시간)

#### 3.1 데이터 모델
```typescript
interface DailyWorker {
  id: string;
  name: string;
  salary_in_10k: number; // 만원 단위
  salary: number; // 원 단위 (자동 계산)
  yearMonth: string;
  notes?: string;
  createdAt: Date;
  createdBy: string;
}
```

#### 3.2 백엔드 API
- [ ] POST `/api/payroll/daily-workers` - 일용직 급여 저장
- [ ] GET `/api/payroll/daily-workers/:yearMonth` - 월별 조회
- [ ] DELETE `/api/payroll/daily-workers/:id` - 삭제
- [ ] GET `/api/payroll/stats/:yearMonth` - 통계 API에 일용직 급여 포함

#### 3.3 프론트엔드 컴포넌트
- [ ] `DailyWorkerManagement` 컴포넌트 생성
- [ ] 급여 관리 페이지에 새 탭 추가: "일용직 관리"
- [ ] 테이블 형태로 입력/수정/삭제
- [ ] 복사 기능 구현 (형식: "2025년 8월 일용직\n홍길동: 1,500,000원")

### Phase 4: UI 변경사항 (30분)

#### 4.1 인센티브 계산기 탭 제거
- [ ] PayrollManagement.tsx에서 "인센티브 계산" 탭 제거
- [ ] IncentiveCalculator 컴포넌트 import 제거

#### 4.2 총 급여 통계 수정
- [ ] 대시보드 상단 통계 카드에 일용직 급여 포함
- [ ] "당월 총 급여" = 정규직 급여 + 일용직 급여

## 🔄 데이터 흐름

```mermaid
graph LR
    A[매출 입력] --> B[매출 저장]
    B --> C[인센티브 자동 계산]
    C --> D[결과 표시]
    D --> E[복사 버튼]
    E --> F[클립보드]
    
    G[일용직 입력] --> H[일용직 저장]
    H --> I[일용직 목록 표시]
    I --> J[복사 버튼]
    J --> F
```

## 📊 UI 레이아웃

### 매출 관리 탭 (개선)
```
┌─────────────────────────────────────┐
│  2025년 8월 매출 입력               │
├─────────────────────────────────────┤
│  [회사 전체 매출 입력 섹션]         │
├─────────────────────────────────────┤
│  [개인별 매출 입력 테이블]          │
├─────────────────────────────────────┤
│  [저장] 버튼                        │
├─────────────────────────────────────┤
│  📊 인센티브 계산 결과              │
│  ┌─────────────────────────────┐   │
│  │ 김철수 | PERSONAL_PERCENT   │   │
│  │        | 500,000원          │   │
│  ├─────────────────────────────┤   │
│  │ 이영희 | TOTAL_EXCESS       │   │
│  │        | 300,000원          │   │
│  └─────────────────────────────┘   │
│  총 인센티브: 800,000원             │
│  [📋 복사하기]                      │
└─────────────────────────────────────┘
```

### 일용직 관리 탭 (신규)
```
┌─────────────────────────────────────┐
│  2025년 8월 일용직 급여             │
├─────────────────────────────────────┤
│  [+ 일용직 추가]                    │
├─────────────────────────────────────┤
│  이름    | 급여(만원) | 비고 | 삭제 │
│  홍길동  | 150       | ...  | 🗑️   │
│  김일용  | 120       | ...  | 🗑️   │
├─────────────────────────────────────┤
│  총 일용직 급여: 2,700,000원        │
│  [📋 복사하기]                      │
└─────────────────────────────────────┘
```

## ✅ 테스트 시나리오

### 인센티브 자동 계산
1. 매출 데이터 입력
2. 저장 버튼 클릭
3. 인센티브 자동 계산 확인
4. 복사 버튼 클릭
5. 클립보드 내용 확인

### 일용직 관리
1. 일용직 추가
2. 급여 입력 (만원 단위)
3. 저장 및 목록 확인
4. 복사 버튼 클릭
5. 클립보드 내용 확인

## 📝 완료 조건
- [x] 매출 저장 시 인센티브가 자동으로 계산되고 표시됨
- [x] 인센티브 복사 기능이 정상 작동
- [x] 일용직 급여 CRUD 기능 완료
- [x] 일용직 급여 복사 기능 정상 작동
- [x] 모든 기능에 대한 에러 처리 완료
- [x] 사용자 피드백 (토스트 알림) 구현

## 🚀 배포 전 체크리스트
- [ ] 개발 환경 테스트 완료
- [ ] 프로덕션 환경 변수 확인
- [ ] 데이터베이스 마이그레이션 필요 여부 확인
- [ ] API 문서 업데이트