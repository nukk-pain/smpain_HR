# ✅ 통합 문서 컬렉션 마이그레이션 체크리스트

## 📊 진행 상황 대시보드

| Phase | 완료 | 전체 | 진행률 | 상태 |
|-------|------|------|--------|------|
| Phase 0: 사전 준비 | 0 | 5 | 0% | 🔴 대기 |
| Phase 1: 준비 단계 | 0 | 12 | 0% | 🔴 대기 |
| Phase 2: Backend 수정 | 0 | 11 | 0% | 🔴 대기 |
| Phase 3: 데이터 마이그레이션 | 0 | 8 | 0% | 🔴 대기 |
| Phase 4: Frontend 수정 | 0 | 5 | 0% | 🔴 대기 |
| Phase 5: 테스트 | 0 | 9 | 0% | 🔴 대기 |
| Phase 6: 배포 | 0 | 9 | 0% | 🔴 대기 |
| Phase 7: 마무리 | 0 | 4 | 0% | 🔴 대기 |
| **전체** | **0** | **63** | **0%** | **🔴 시작 전** |

---

## 📅 타임라인

```
Day 1 AM: Phase 0-1 (사전 준비 & 준비 단계)
Day 1 PM: Phase 2 (Backend 수정)
Day 2 AM: Phase 3 (데이터 마이그레이션)
Day 2 PM: Phase 4 (Frontend 수정)
Day 3 AM: Phase 5 (테스트)
Day 3 PM: Phase 6 (배포)
Day 3+: Phase 7 (마무리 및 모니터링)
```

---

## 📋 상세 체크리스트

### 🎯 Phase 0: 사전 준비 (필수) 
**담당자:** ___________ | **목표 완료:** ___________

- [ ] 프로젝트 승인 받기
  - 승인자: ___________
  - 승인일: ___________
- [ ] 마이그레이션 일정 확정
  - 시작일: ___________
  - 종료일: ___________
- [ ] 팀원 역할 분담
- [ ] 위험 요소 최종 검토
- [ ] 롤백 계획 검토 및 승인

### 📦 Phase 1: 준비 단계 (Day 1 AM)
**담당자:** ___________ | **목표 완료:** ___________

#### 1.1 백업 생성
- [ ] Production DB 전체 백업 실행
  - 백업 시작: ___________
  - 백업 완료: ___________
  - 백업 크기: ___________GB
- [ ] 백업 파일 검증 (복원 가능 여부 테스트)
- [ ] 백업 파일 안전한 위치에 저장
  - 저장 위치: ___________
- [ ] 백업 스크립트 작성 (`/backend/scripts/backupDocumentCollections.js`)

#### 1.2 통합 레포지토리 생성
- [ ] `/backend/repositories/UnifiedDocumentRepository.js` 파일 생성
- [ ] 기존 3개 레포지토리 메서드 통합 구현
- [ ] Repository 단위 테스트 작성
- [ ] Repository 테스트 실행 및 통과 확인
  - 테스트 결과: ___________

#### 1.3 마이그레이션 스크립트 작성
- [ ] `/backend/scripts/migrateToUnifiedCollection.js` 파일 생성
- [ ] 데이터 변환 함수 구현 (payslips → unified)
- [ ] 데이터 변환 함수 구현 (payroll_documents → unified)
- [ ] 데이터 변환 함수 구현 (documents → unified)
- [ ] 중복 제거 로직 구현
- [ ] 파일 검증 로직 구현
- [ ] 진행 상황 로깅 구현
- [ ] DRY RUN 모드 테스트
  - 테스트 결과: ___________

### 🔧 Phase 2: Backend 수정 (Day 1 PM)
**담당자:** ___________ | **목표 완료:** ___________

#### 2.1 Routes 수정
- [ ] `/backend/routes/documents.js` - 통합 컬렉션 사용하도록 수정
- [ ] `/backend/routes/reports.js` - UnifiedDocumentRepository 사용하도록 수정
- [ ] `/backend/routes/payslip-verify.js` - 검증 로직 수정
- [ ] `/backend/routes/payroll.js` - 급여 연동 수정

#### 2.2 Repository 전환
- [ ] PayrollDocumentRepository → UnifiedDocumentRepository 전환
- [ ] 메서드 시그니처 호환성 확인
- [ ] Backward compatibility 테스트

#### 2.3 인덱스 생성
- [ ] `/backend/scripts/createUnifiedIndexes.js` 스크립트 작성
- [ ] 복합 인덱스 생성 실행
- [ ] 텍스트 검색 인덱스 생성
- [ ] Partial 인덱스 생성
- [ ] 인덱스 성능 테스트
  - 테스트 결과: ___________

### 🚀 Phase 3: 데이터 마이그레이션 (Day 2 AM)
**담당자:** ___________ | **목표 완료:** ___________

#### 3.1 마이그레이션 실행 준비
- [ ] 마이그레이션 환경 변수 설정
- [ ] 체크포인트 저장 디렉토리 생성
- [ ] 로그 파일 디렉토리 준비

#### 3.2 마이그레이션 실행
- [ ] DRY RUN 모드로 최종 테스트
  - 예상 문서 수: ___________
  - 예상 소요 시간: ___________
- [ ] 실제 마이그레이션 시작
  - 시작 시간: ___________
- [ ] 진행 상황 모니터링
- [ ] 오류 로그 확인
  - 오류 수: ___________
- [ ] 마이그레이션 완료 확인
  - 완료 시간: ___________
  - 총 소요 시간: ___________

#### 3.3 데이터 검증
- [ ] 총 레코드 수 일치 확인
  - 원본: ___________
  - 마이그레이션: ___________
  - 차이: ___________
- [ ] 중복 제거 결과 확인
  - 제거된 중복: ___________
- [ ] 필수 필드 존재 확인
- [ ] 파일 경로 유효성 확인
  - 누락 파일: ___________
- [ ] 사용자 정보 매핑 확인

### 💻 Phase 4: Frontend 수정 (Day 2 PM)
**담당자:** ___________ | **목표 완료:** ___________

#### 4.1 API Service 수정
- [ ] `/frontend/src/services/api.ts` - 필드명 매핑 확인
- [ ] 응답 타입 검증

#### 4.2 Component 수정
- [ ] `MyDocuments.tsx` - 필드명 호환성 확인
- [ ] `AdminDocuments.tsx` - 새 스키마 필드 활용
- [ ] `PayslipManagement.tsx` - 업로드 로직 확인

### 🧪 Phase 5: 테스트 (Day 3 AM)
**담당자:** ___________ | **목표 완료:** ___________

#### 5.1 자동화 테스트
- [ ] Unit 테스트 전체 실행
  - 통과: ___________ / 실패: ___________
- [ ] Integration 테스트 실행
  - 통과: ___________ / 실패: ___________
- [ ] E2E 테스트 실행
  - 통과: ___________ / 실패: ___________
- [ ] 성능 벤치마크 테스트
  - 평균 응답 시간: ___________ms

#### 5.2 수동 테스트
- [ ] 사용자 문서함 접근 테스트
- [ ] 문서 다운로드 테스트
- [ ] Admin 문서 관리 테스트
- [ ] Bulk upload 테스트
- [ ] 문서 삭제/복원 테스트

### 🚢 Phase 6: 배포 (Day 3 PM)
**담당자:** ___________ | **목표 완료:** ___________

#### 6.1 Production 배포
- [ ] Production 환경 최종 백업
  - 백업 완료: ___________
- [ ] 서비스 점검 공지
  - 공지 시간: ___________
- [ ] 마이그레이션 실행
  - 시작: ___________
  - 완료: ___________
- [ ] 서비스 재시작
- [ ] 모니터링 시작

#### 6.2 배포 후 검증
- [ ] API 응답 시간 확인
  - 평균: ___________ms
- [ ] 에러율 모니터링
  - 에러율: ___________%
- [ ] 사용자 피드백 수집
- [ ] 24시간 안정성 모니터링

### ✨ Phase 7: 마무리
**담당자:** ___________ | **목표 완료:** ___________

- [ ] 이전 컬렉션 아카이브
- [ ] 문서화 업데이트
- [ ] 팀 회고 미팅
  - 일시: ___________
- [ ] 최종 보고서 작성

---

## 🚨 긴급 롤백 체크리스트 (필요시)

**롤백 결정자:** ___________ | **롤백 시작:** ___________

- [ ] 서비스 즉시 중단
  - 중단 시간: ___________
- [ ] 통합 컬렉션 백업
- [ ] 원본 컬렉션 복원
  - 복원 시작: ___________
  - 복원 완료: ___________
- [ ] 이전 코드 버전 배포
  - 버전: ___________
- [ ] 서비스 재시작
  - 재시작 시간: ___________
- [ ] 롤백 원인 분석
  - 원인: ___________

---

## 📝 주요 연락처

| 역할 | 이름 | 연락처 | 비고 |
|------|------|--------|------|
| 기술 리드 | | | |
| Backend 개발 | | | |
| Frontend 개발 | | | |
| QA | | | |
| DevOps | | | |
| PM | | | |
| 긴급 연락처 | | | 24/7 |

---

## 📈 주요 지표 추적

### 마이그레이션 전
- 총 문서 수: ___________
- 평균 쿼리 시간: ___________ms
- 저장 공간: ___________GB

### 마이그레이션 후
- 총 문서 수: ___________
- 평균 쿼리 시간: ___________ms
- 저장 공간: ___________GB
- 중복 제거: ___________건
- 성능 개선: ___________%

---

## 🔗 관련 문서
- [전체 마이그레이션 계획](/mnt/d/my_programs/HR/unified-collection-migration-plan.md)
- [UnifiedDocumentRepository 구현]()
- [마이그레이션 스크립트]()
- [테스트 결과 보고서]()
- [롤백 계획 상세]()

---

**마지막 업데이트:** 2025-01-20
**다음 체크포인트:** ___________